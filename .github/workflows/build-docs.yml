name: Deploy

on:
 push:
   branches:
     - docs

jobs:
 deploy:
   runs-on: ubuntu-latest

   steps:
     - name: Checkout repository
       uses: actions/checkout@v2

     - name: Build and deploy
       run: |
         npm install
         npm run build
         rm -rf dist/*
         mv public/* dist/
         cd public
         git init
         git config user.name "{{ github.actor }}"
         git config user.email "{{ github.actor }}@users.noreply.github.com"
         git add .
         git commit -m "Deploy dist"
         git branch -M docs
         git push --force "https://{{ github.token }}@github.com/{{ github.repository }}" master:gh-pages